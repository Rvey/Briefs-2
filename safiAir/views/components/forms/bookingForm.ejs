<div class="container m-auto">
  <div class="flex justify-center px-6 my-12">
    <!-- Row -->
    <div class="w-full flex">
      <!-- Col -->
      <!-- <div
        class="
          w-full
          h-auto
          bg-gray-400
          hidden
          lg:block lg:w-5/12
          bg-cover
          rounded-l-lg
        "
      ></div> -->
      <!-- Col -->
      <div class="w-full bg-white p-5 rounded-lg lg:rounded-l-none">
        <form
          class="
            flex flex-col
            justify-between
            px-8
            pt-6
            pb-8
            mb-4
            bg-white
            rounded
            userForm
            h-[28em]
          "
        >
          <!-- user information -->
          <div>
            <div class="mb-4 flex gap-6">
              <div class="mb-4 md:mr-2 md:mb-0 w-full">
                <label class="block mb-2 text-sm font-bold text-gray-700">
                  firstName
                </label>
                <input
                  class="
                    w-full
                    px-3
                    py-2
                    mb-3
                    text-sm
                    leading-tight
                    text-gray-700
                    border
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-2
                  "
                  type="text"
                  name="fname"
                />
              </div>
              <div class="md:ml-2 w-full">
                <label class="block mb-2 text-sm font-bold text-gray-700">
                  Last Name
                </label>
                <input
                  class="
                    w-full
                    px-3
                    py-2
                    mb-3
                    text-sm
                    leading-tight
                    text-gray-700
                    border
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-2
                  "
                  type="text"
                  name="lname"
                />
              </div>
            </div>

            <div class="mb-4 flex gap-6">
              <div class="mb-4 md:mr-2 md:mb-0 w-full">
                <label class="block mb-2 text-sm font-bold text-gray-700">
                  Phone Number
                </label>
                <input
                  class="
                    w-full
                    px-3
                    py-2
                    mb-3
                    text-sm
                    leading-tight
                    text-gray-700
                    border
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-2
                  "
                  type="number"
                  name="phone"
                />
              </div>
              <div class="md:ml-2 w-full">
                <label class="block mb-2 text-sm font-bold text-gray-700">
                  Email
                </label>
                <input
                  class="
                    w-full
                    px-3
                    py-2
                    mb-3
                    text-sm
                    leading-tight
                    text-gray-700
                    border
                    rounded
                    appearance-none
                    focus:outline-none focus:ring-2
                  "
                  type="email"
                  name="email"
                />
              </div>
            </div>
          </div>

          <div class="text-center">
            <hr class="border-t" />
            <button
              class="
                w-full
                px-4
                py-2
                font-bold
                text-white
                bg-indigo-500
                rounded-md
                hover:bg-indigo-700
                focus:outline-none focus:ring-2
              "
              type="submit"
            >
              Book
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  const userForm = document.querySelector(".userForm");
  const planID = JSON.parse(sessionStorage.getItem("selectedFlight"));
  const seat = JSON.parse(sessionStorage.getItem("seats"));
  const planSeats = JSON.parse(sessionStorage.getItem("flightSeats"));
  const seats =  {seats : parseInt(planSeats - seat)};
  // fetch(`http://localhost:5000/api/plan/${planID}`)
  //   .then((response) => response.json())
  //   .then((data) => console.log(data));
  userForm.addEventListener("submit", (e) => {
    e.preventDefault();
    // console.log(userForm.email.value , userForm.phone.value , userForm.lname.value , userForm.fname.value);
    const user = {
      fname: userForm.fname.value,
      lname: userForm.lname.value,
      email: userForm.email.value,
      phone: userForm.phone.value,
      seats: seat,
      planID: planID,
    };
    fetch("http://localhost:5000/api/user", {
      method: "POST", // or 'PUT'
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(user),
    }).then(() => {
      fetch(`http://localhost:5000/api/plan/${planID}`, {
        method: "PUT", // or 'PUT'
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(seats),
      });
    });
  });
</script>
